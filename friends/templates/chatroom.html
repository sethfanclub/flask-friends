{% extends 'base.html' %}
{% block head %} 
   <title>Friends - Chatroom</title>
{% endblock %} 
{% block content %} 
   <style>
      ul {margin:0; padding:0;}
      li {list-style-type:none;}
   </style>
   <div class="row mt-5">
      <div class="col-md-6 mx-auto bg-light border p-5 position-relative">
         <ul class="my-2" id="messages"></ul>
         <div class="d-flex gap-0">
            <input class="form-control" type="text" id="message-input">
            <button id="message-send" class="btn btn-primary" type="button">Send</button>
         </div>
      </div>
   </div>
   <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
   <script type="text/javascript" charset="UTF-8">
      var socket
      let messages = document.getElementById('messages')
      let sendButton = document.getElementById('message-send')
      document.addEventListener('DOMContentLoaded', function() {
         socket = io.connect('http://'+document.domain+':'+location.port+'/chatroom')
         socket.on('message', function(data) {
            sendMessage(data.text)
         })
      })

      sendButton.onclick = function() {
            text = document.getElementById('message-input').value
            socket.emit('send_message', text)
      }
      function sendMessage(text) {
         newMessage = document.createElement('li')
         newMessage.innerText = text
         messages.appendChild(newMessage)
      }
    </script>
{% endblock %}